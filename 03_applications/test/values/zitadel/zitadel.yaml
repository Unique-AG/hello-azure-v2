chownImage:
  repository: uqhacrtest.azurecr.io/alpine
  tag: 3.19
image:
  repository: uqhacrtest.azurecr.io/zitadel/zitadel
  tag: v2.71.13
nodeSelector:
  scalability: steady
  lifecycle: persistent
ingress:
  enabled: false
securityContext:
  allowPrivilegeEscalation: false
env:
  - name: ZITADEL_DATABASE_POSTGRES_USER_USERNAME
    value: z1t4d3l
  - name: ZITADEL_DATABASE_POSTGRES_USER_PASSWORD
    valueFrom:
      secretKeyRef:
        name: helloazuresensitivezitadel
        key: ZITADEL_DATABASE_POSTGRES_USER_PASSWORD
  - name: ZITADEL_DATABASE_POSTGRES_HOST
    valueFrom:
      secretKeyRef:
        name: helloazuresensitivezitadel
        key: ZITADEL_DATABASE_POSTGRES_HOST
  - name: ZITADEL_DATABASE_POSTGRES_PORT
    valueFrom:
      secretKeyRef:
        name: helloazuresensitivezitadel
        key: ZITADEL_DATABASE_POSTGRES_PORT
  - name: ZITADEL_DATABASE_POSTGRES_ADMIN_USERNAME
    valueFrom:
      secretKeyRef:
        name: helloazuresensitivezitadel
        key: ZITADEL_DATABASE_POSTGRES_ADMIN_USERNAME
  - name: ZITADEL_DATABASE_POSTGRES_ADMIN_PASSWORD
    valueFrom:
      secretKeyRef:
        name: helloazuresensitivezitadel
        key: ZITADEL_DATABASE_POSTGRES_ADMIN_PASSWORD
zitadel:
  dbSslCaCrtSecret: zitadel-certs
  # The chart: https://github.com/zitadel/zitadel-charts/blob/main/charts/zitadel/values.yaml
  masterkeySecretName: helloazuresensitivezitadel
  secretConfig:
    Database:
      postgres:
        Database: zitadel
        MaxOpenConns: 50
        MaxIdleConns: 10
        MaxConnLifetime: 1h
        MaxConnIdleTime: 5m
        Options:
        User:
          SSL:
            Mode: verify-full
            RootCert: /.secrets/ca.crt
            Cert:
            Key:
        Admin:
          SSL:
            Mode: verify-full
            RootCert: /.secrets/ca.crt
            Cert:
            Key:
    FirstInstance:
      Org:
        Name: Cluster IAM
        Human:
          Username: root@cluster-iam.localhost
          Password: "RootPassword1!" # must be changed on first login so not a problem
  configmapConfig:
    # All values: https://github.com/zitadel/zitadel/blob/main/cmd/defaults.yaml
    ExternalDomain: id.test-hello.azure.unique.dev
    ExternalPort: 443
    ExternalSecure: true
    LogStore:
      Access:
        Stdout:
          Enabled: true
    TLS:
      Enabled: false # Application Gateway from Azure does this
    UserAgentCookie:
      Name: uniqueid.useragent
    Login:
      LanguageCookieName: uniqueid.login.lang
      CSRFCookieName: uniqueid.login.csrf
    Quotas:
      Access:
        ExhaustedCookieKey: uniqueid.quota.exhausted
    SystemDefaults:
      Multifactors:
        OTP:
          Issuer: UNIQUE
      KeyConfig:
        PrivateKeyLifetime: 2160h # 90 days
        PublicKeyLifetime: 8760h # 1year. Public key lifetime must be min 2x private key lifetime
    DefaultInstance:
      InstanceName: UNIQUE
      DefaultLanguage: en
      DomainPolicy:
        UserLoginMustBeDomain: false
        ValidateOrgDomain: false
      LoginPolicy:
        AllowDomainDiscovery: true
        AllowRegister: false
      PrivacyPolicy:
        TOSLink: https://www.unique.ch/terms
        PrivacyLink: https://www.unique.ch/privacy
        SupportEmail: support@unique.ch
        HideLoginNameSuffix: true
        ErrorMsgPopup: false
        DisableWatermark: true
    FirstInstance:
      InstanceName: UNIQUE
      DefaultLanguage: en
      DomainPolicy:
        UserLoginMustBeDomain: false
        ValidateOrgDomain: false
      LoginPolicy:
        AllowDomainDiscovery: true
        AllowRegister: false
replicaCount: 2
resources:
  requests:
    cpu: 1
    memory: 1Gi
  limits:
    memory: 1Gi
initJob:
  resources:
    requests:
      cpu: 100m
      memory: 512Mi
    limits:
      memory: 512Mi
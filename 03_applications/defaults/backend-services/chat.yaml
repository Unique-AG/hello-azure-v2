autoscaling:
  enabled: true
  maxReplicas: 6
  minReplicas: 2
  targetCPUUtilizationPercentage: 80
  targetMemoryUtilizationPercentage: 80
cronJob:
  concurrencyPolicy: Forbid
  enabled: true
  env:
    RUNNING_MODE: "DATA_REDACTION_TASK"
  failedJobsHistoryLimit: 2
  jobTemplate:
    containers:
      name: redaction-job
    restartPolicy: Never
  name: data-redaction-task
  schedule: 0 0 * * *
  startingDeadlineSeconds: 10
  successfulJobsHistoryLimit: 1
  suspend: false
  timeZone: Europe/Zurich
env:
  ADMIN_FRONTEND_URL: unset_default_value
  AMQP_BENCHMARK_PREFETCH: 1
  ANONYMIZED_CHAT_INTERACTIONS_EXPORT: "false"
  APP_REPOSITORY_URL: http://node-app-repository.unique.svc
  ASSISTANT_CORE_API_URL: http://assistants-core.unique.svc
  AUDIT_LOG_DIR: /dev/stdout
  BENCHMARKS_PER_MINUTE_PER_PROCESS: 1
  CACHE_REDIS_DB: 3
  CHAT_FRONTEND_URL: unset_default_value
  DATABASE_CONNECTION_POOL_LIMIT: "30"
  ENABLE_CLIENT_INSIGHT_SHIPPER: "true"
  EXPORT_PROMPTS_ACCESS_CONTROL: "true"
  ENABLE_DOWNLOAD_UPLOAD_FILES_AS_STREAM: "true"
  ENABLE_UPLOAD_CHAT_INTERACTIONS_AS_STREAM: "true"
  ENABLE_ANALYTICS_CHAT_DETAILED_INTERACTIONS_PRISMA_CURSOR: "true"
  INGESTION_API_URL: http://backend-service-ingestion.unique.svc
  INTERNAL_MODULES_CONFIG: >-
    [
    {"name": "SearchInVectorDBV2", "apiURL": "http://assistants-core.unique.svc.cluster.local:8081/core/search"},
    {"name": "ImageSummarizer", "apiURL": "http://assistants-core.unique.svc.cluster.local:8081/core/image_summarizer"},
    {"name": "TranslationOneToOne", "apiURL": "http://assistants-core.unique.svc.cluster.local:8081/core/translation_one_to_one"},
    {"name": "WebSearch", "apiURL": "http://assistants-core.unique.svc.cluster.local:8081/core/web_search"},
    {"name": "ComplianceCheck", "apiURL": "http://assistants-core.unique.svc.cluster.local:8081/core/compliance_check"},
    {"name": "QuestionExtractor", "apiURL": "http://assistants-core.unique.svc.cluster.local:8081/core/question_extractor"},
    {"name": "QuestionAnswerer", "apiURL": "http://assistants-core.unique.svc.cluster.local:8081/core/question_answerer"},
    {"name": "Questionnaire", "apiURL": "http://assistants-core.unique.svc.cluster.local:8081/core/question_answerer"},
    {"name": "QuestionPredictor", "apiURL": "http://assistants-core.unique.svc.cluster.local:8081/core/question_predictor"},
    {"name": "DocumentSummarizerV2", "apiURL": "http://assistants-core.unique.svc.cluster.local:8081/core/document_summarizer"},
    {"name": "ImageUpload", "apiURL": "http://assistants-core.unique.svc.cluster.local:8081/core/image_upload"},
    {"name": "DocumentTranslator", "apiURL": "http://assistants-core.unique.svc.cluster.local:8081/core/document_translator"},
    {"name": "AgenticSearch", "apiURL": "http://assistants-core.unique.svc.cluster.local:8081/core/agentic_search"},
    {"name": "TranslatorV2", "apiURL": "http://assistants-core.unique.svc.cluster.local:8081/core/translator_v2"},
    {"name": "InvestmentResearch", "apiURL": "http://assistants-core.unique.svc.cluster.local:8081/core/investment_research"},
    {"name": "EarningCallsBeta", "apiURL": "http://assistants-core.unique.svc.cluster.local:8081/core/earning_calls"},
    {"name": "HallucinationLevelEvaluation", "apiURL": "http://assistants-core.unique.svc.cluster.local:8081/core/evaluations/hallucination-level"},
    {"name": "DueDiligence", "apiURL": "http://assistants-core.unique.svc.cluster.local:8081/core/magic_table_dd"},
    {"name": "RfpAgent", "apiURL": "http://assistants-core.unique.svc.cluster.local:8081/core/rfp_agent"},
    {"name": "UniqueAi", "apiURL": "http://assistants-core.chat.svc.cluster.local:8081/core/unique_ai"},
    {"name": "KycReviewAgent", "apiURL": "http://assistants-core.unique.svc.cluster.local:8081/core/kyc_review_agent"}
    ]
  LOG_LEVEL: info
  MAX_HEAP_MB: 3700
  MIN_NO_OF_MESSAGES_BY_USER_BEFORE_NPS_TRIGGER: "30"
  OPENAI_PROVIDER: azure
  PUBSUB_BACKEND: redis
  PUBSUB_REDIS_DB: 2
  SCOPE_MANAGEMENT_API_URL: http://backend-service-scope-management.unique.svc
envVars:
  - name: AMQP_USERNAME
    valueFrom:
      secretKeyRef:
        name: rabbitmqcluster-chat-default-user
        key: username
  - name: AMQP_PASSWORD
    valueFrom:
      secretKeyRef:
        name: rabbitmqcluster-chat-default-user
        key: password
  - name: AMQP_HOST
    valueFrom:
      secretKeyRef:
        name: rabbitmqcluster-chat-default-user
        key: host
  - name: AMQP_PORT
    valueFrom:
      secretKeyRef:
        name: rabbitmqcluster-chat-default-user
        key: port
hooks:
  migration:
    command: |
      cd /home/node/app/services/node-chat/prisma; npx prisma migrate deploy; cd /home/node/app/services/node-chat/dist; RUNNING_MODE=DATA_MIGRATION node /home/node/app/services/node-chat/dist/main.js;
    enabled: true
nodeSelector:
  scalability: steady
  lifecycle: persistent
resources:
  limits:
    cpu: 500m
    memory: 600Mi
  requests:
    cpu: 500m
    memory: 550Mi
routes:
  gateway:
    namespace: unique
  pathPrefix: /chat
  paths:
    default:
      enabled: true
    versioned:
      enabled: true
    probe:
      enabled: true
serviceAccount:
  enabled: true
  workloadIdentity:
    enabled: true

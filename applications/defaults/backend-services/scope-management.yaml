cronJob:
  concurrencyPolicy: Forbid
  enabled: true
  env:
    RUNNING_MODE: user-sync
  failedJobsHistoryLimit: 2
  jobTemplate:
    containers:
      name: scope-management-user-sync
    restartPolicy: Never
  name: user-sync
  schedule: "*/5 * * * *"
  startingDeadlineSeconds: 10
  successfulJobsHistoryLimit: 1
  suspend: false
  timeZone: Europe/Zurich
env:
  AUDIT_LOG_DIR: /dev/stdout
  CHAT_API_URL: http://backend-service-chat.unique.svc
  ENABLE_CLIENT_INSIGHT_SHIPPER: "true"
  INGESTION_API_URL: http://backend-service-ingestion.unique.svc
  LOG_LEVEL: info
  MAX_HEAP_MB: 750
  ZITADEL_GRPC_HOST: http://zitadel.unique.svc.cluster.local:8080
envVars:
  - name: AMQP_USERNAME
    valueFrom:
      secretKeyRef:
        name: rabbitmqcluster-chat-default-user
        key: username
  - name: AMQP_PASSWORD
    valueFrom:
      secretKeyRef:
        name: rabbitmqcluster-chat-default-user
        key: password
  - name: AMQP_HOST
    valueFrom:
      secretKeyRef:
        name: rabbitmqcluster-chat-default-user
        key: host
  - name: AMQP_PORT
    valueFrom:
      secretKeyRef:
        name: rabbitmqcluster-chat-default-user
        key: port
nodeSelector:
  scalability: steady
  lifecycle: persistent
hooks:
  migration:
    command: |
      cd /home/node/app/services/node-scope-management/prisma; npx prisma migrate deploy; cd /home/node/app/services/node-scope-management/dist; RUNNING_MODE=DATA_MIGRATION  node /home/node/app/services/node-scope-management/dist/main.js;
    enabled: true
replicaCount: 1
resources:
  limits:
    cpu: 1
    memory: 900Mi
  requests:
    cpu: 500m
    memory: 850Mi
routes:
  gateway:
    namespace: unique
  pathPrefix: /scope-management
  paths:
    default:
      enabled: true
    probe:
      enabled: true
